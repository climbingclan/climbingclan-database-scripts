CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`%` SQL SECURITY DEFINER VIEW `wp_order_product_customer_lookup_new` AS select distinct `a`.`order_id` AS `order_id`,`c`.`product_id` AS `product_id`,`c`.`variation_id` AS `variation_id`,`c`.`product_net_revenue` AS `order_value`,`wpo`.`order_item_name` AS `order_item_name`,`a`.`status` AS `status`,`a`.`customer_id` AS `customer_id`,`b`.`_customer_user` AS `user_id`,`d`.`post_date` AS `order_created`,max(case when `pm1`.`meta_key` = 'cc_attendance' then `pm1`.`meta_value` end) AS `cc_attendance`,max(case when `pm1`.`meta_key` = 'cc_volunteer_attendance' then `pm1`.`meta_value` end) AS `cc_volunteer_attendance`,max(case when `pm1`.`meta_key` = 'cc_volunteer' then `pm1`.`meta_value` end) AS `cc_volunteer`,max(case when `pm1`.`meta_key` = 'cc_location' then `pm1`.`meta_value` end) AS `cc_location`,max(case when `pm1`.`meta_key` = 'memberbot_order_category' then `pm1`.`meta_value` end) AS `memberbot_order_category`,max(case when `pm1`.`meta_key` = 'cc_outdoor_location' then `pm1`.`meta_value` end) AS `cc_outdoor_location`,max(case when `pm1`.`meta_key` = 'cc_indoor_location' then `pm1`.`meta_value` end) AS `cc_indoor_location`,max(case when `pm1`.`meta_key` = 'cc_attendance_sim' then `pm1`.`meta_value` end) AS `cc_attendance_sim`,max(case when `pm1`.`meta_key` = 'cc_volunteer_attendance_sim' then `pm1`.`meta_value` end) AS `cc_volunteer_attendance_sim`,max(case when `pm1`.`meta_key` = 'cc_volunteer_sim' then `pm1`.`meta_value` end) AS `cc_volunteer_sim`,max(case when `pm1`.`meta_key` = 'cc_outdoor_location_sim' then `pm1`.`meta_value` end) AS `cc_outdoor_location_sim`,(select distinct `wp_woocommerce_order_itemmeta`.`meta_value` from `wp_woocommerce_order_itemmeta` where `wp_woocommerce_order_itemmeta`.`order_item_id` = `wpo`.`order_item_id` and `wp_woocommerce_order_itemmeta`.`meta_key` in ('are-you-signed-off-to-top-rope-belay-yet','what-describes-you-best','can-you-lead-trad-at-grade-mod-or-above','membership-type','can-you-lead-trad-at-grade-mod-or-above-or-independently-lead-sport-outdoors-at-grade-4-and-above') limit 1) AS `signup_option` from (((((((`wp_wc_order_stats` `a` left join `wp_postmeta` `pm1` on(`a`.`order_id` = `pm1`.`post_id`)) left join `wp_wc_order_product_lookup` `c` on(`a`.`order_id` = `c`.`order_id`)) left join `wp_posts` `d` on(`a`.`order_id` = `d`.`ID`)) left join `wp_woocommerce_order_items` `wpo` on(`a`.`order_id` = `wpo`.`order_id`)) left join `wp_woocommerce_order_itemmeta` `woim` on(`wpo`.`order_item_id` = `woim`.`order_item_id`)) left join `wp_tickets_fakedb` `o` on(`c`.`order_item_id` = `o`.`order_item_id`)) left join `wp_customers_tickets_lookup` `b` on(`a`.`order_id` = `b`.`ID`)) group by `a`.`order_id` order by `a`.`order_id`