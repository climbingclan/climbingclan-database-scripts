CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`%` SQL SECURITY DEFINER VIEW `wp_member_db_attendance_score` AS select `u`.`ID` AS `user_id`,(select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_volunteer` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` in ('attended','no-register-show') and `wp_order_product_customer_lookup`.`cc_volunteer` not in ('none','')) AS `cc_volunteered_for_numerator`,(select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_volunteer` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` in ('cancelled','bail','no-show','late-bail') and `wp_order_product_customer_lookup`.`cc_volunteer` not in ('none','')) AS `cc_volunteered_for_but_no_attend`,(select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_attended` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` not in ('duplicate','')) AS `cc_volunteered_for_denominator`,(select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_attendance` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` = 'attended') AS `attended`,(select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_attendance` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` is not null) AS `signups`,(select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_attendance` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` in ('bail','cancelled','cancel')) AS `cancelled`,(select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_attendance` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` = 'no-register-show') AS `noregistershow`,(select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_attendance` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` = 'noshow') AS `noshow`,(select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_attendance` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` = 'late-bail') AS `latebail`,(select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_attendance` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` = 'duplicate') AS `duplicate`,(select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_attendance` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-processing' and `wp_order_product_customer_lookup`.`cc_attendance` = 'pending') AS `inprogress`,(select 100 - 1 * (select count(`wp_order_product_customer_lookup`.`cc_attendance`) from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` in ('bail','cancelled','cancel')) - 7 * (select count(`wp_order_product_customer_lookup`.`cc_attendance`) from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` = 'noshow') - 3 * (select count(`wp_order_product_customer_lookup`.`cc_attendance`) from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` = 'late-bail') + 2 * (select count(`wp_order_product_customer_lookup`.`cc_attendance`) from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` = 'no-register-show') + 5 * (select count(`wp_order_product_customer_lookup`.`cc_attendance`) from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` = 'attended')) AS `attendance_score`,(select 100 * ((select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_volunteer` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` in ('attended','no-register-show') and `wp_order_product_customer_lookup`.`cc_volunteer` not in ('none','')) / (select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_attended` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` not in ('duplicate',''))) - 2 * (select count(`wp_order_product_customer_lookup`.`order_item_name`) AS `cc_volunteer` from `wp_order_product_customer_lookup` where `wp_order_product_customer_lookup`.`user_id` = `u`.`ID` and `wp_order_product_customer_lookup`.`status` = 'wc-completed' and `wp_order_product_customer_lookup`.`cc_attendance` in ('cancelled','bail','no-show','late-bail') and `wp_order_product_customer_lookup`.`cc_volunteer` not in ('none','')) AS `cc_volunteered_for_but_no_attend`) AS `volunteer_score` from `wp_member_db` `u`