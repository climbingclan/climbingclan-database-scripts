CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`%` SQL SECURITY DEFINER VIEW `category_quarter_summary_negative` AS select `all_quarters`.`year` AS `year`,`all_quarters`.`quarter` AS `quarter`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Back Office Supplies' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Back Office Supplies`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Balance Transfer' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Balance Transfer`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Bank Fees' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Bank Fees`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'BMC Membership Fees' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `BMC Membership Fees`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Cake' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Cake`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Cards' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Cards`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Direct Debit' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Direct Debit`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Equipment' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Equipment`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Facebook Advertising' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Facebook Advertising`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'General Expenses' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `General Expenses`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Grants' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Grants`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Inbound BACS Payment' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Inbound BACS Payment`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Loan Repayment' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Loan Repayment`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Mugs' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Mugs`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Outbound BACS Payment' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Outbound BACS Payment`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Overnight Accomodation' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Overnight Accomodation`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Overnight Activities' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Overnight Activities`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Overnight Food' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Overnight Food`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Overnight Transport' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Overnight Transport`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Payment from Customer' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Payment from Customer`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Period Club' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Period Club`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Refund' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Refund`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Social Activity Provider' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Social Activity Provider`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Social Media' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Social Media`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Thinking Digital Conference' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Thinking Digital Conference`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Training Provider' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Training Provider`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Web Infrastructure' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Web Infrastructure`,coalesce(sum(case when `wp_member_accounts_with_quarters`.`payment_category` = 'Wednesday Night Supplies' and `wp_member_accounts_with_quarters`.`net` < 0 then `wp_member_accounts_with_quarters`.`net` else 0 end),0) AS `Wednesday Night Supplies` from (`all_quarters` left join `wp_member_accounts_with_quarters` on(`all_quarters`.`year` = `wp_member_accounts_with_quarters`.`year` and `all_quarters`.`quarter` = `wp_member_accounts_with_quarters`.`quarter`)) group by `all_quarters`.`year`,`all_quarters`.`quarter`